// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL_PRISMA")
}

model pessoa {
  id       String   @id @default(uuid())
  name     String   @db.VarChar(254)
  gender   Boolean
  birthday DateTime
  surname  String?  @db.VarChar(254)
  nation   String?  @db.Char(2)
  height   Int?
  weight   Int?
  eyes     Int?
  hair     String?  @db.VarChar(254)
  marks    String?  @db.VarChar(254)

  create_time DateTime @default(now())
  update_time DateTime @updatedAt

  location_history    location_history[]
  comments            contents[]
  pessoas_on_contacts pessoas_on_contacts[]
}

model location_history {
  id          Int      @id @default(autoincrement())
  pessoa_id   String
  pessoa      pessoa   @relation(fields: [pessoa_id], references: [id])
  location_id Int
  location    location @relation(fields: [location_id], references: [id])
  visited_at  DateTime

  @@index([pessoa_id])
  @@index([location_id])
}

model location {
  id        Int     @id @default(autoincrement())
  latitude  Decimal @db.Decimal
  longitude Decimal @db.Decimal
  city      Int
  state     Int
  nation    String  @db.Char(2)

  location_history location_history[]
  contact          contact[]
}

model contents {
  id          String   @id @default(uuid())
  content     String   @db.Text
  create_time DateTime @default(now())
  update_time DateTime @updatedAt
  pessoa_id   String
  pessoa      pessoa   @relation(fields: [pessoa_id], references: [id])

  @@index([pessoa_id])
}

model contact {
  email  String   @id @db.VarChar(254)
  tel    String?  @db.VarChar(254)
  name   String   @db.VarChar(254)
  gender Boolean?

  location_id         Int
  location            location              @relation(fields: [location_id], references: [id])
  pessoas_on_contacts pessoas_on_contacts[]

  @@index([location_id])
}

model pessoas_on_contacts {
  pessoa     pessoa  @relation(fields: [pessoa_id], references: [id])
  pessoa_id  String
  contact    contact @relation(fields: [contact_id], references: [email])
  contact_id String

  @@id([pessoa_id, contact_id])
}
